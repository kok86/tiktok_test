<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>TikTok Style Video Feed</title>

<!-- Video.js CSS -->
<link href="https://vjs.zencdn.net/8.9.0/video-js.css" rel="stylesheet" />
<style>
  html, body {
    margin: 0; padding: 0;
    height: 100%;
    background: black;
    overflow: hidden;
    font-family: sans-serif;
  }
  .feed-container {
    height: 100vh;
    width: 100vw;
    overflow-y: scroll;
    scroll-snap-type: y mandatory;
    -webkit-overflow-scrolling: touch;
  }
  .video-slide {
    height: 100vh;
    width: 100vw;
    scroll-snap-align: start;
    position: relative;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .portrait-frame {
    height: 100vh;
    aspect-ratio: 9 / 16;
    position: relative;
    max-width: 100vw;
    background: black;
  }
  video.video-js {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .vjs-control-bar,
  .vjs-big-play-button {
    display: none !important;
  }
  .video-overlay {
    position: absolute;
    top: 20%;
    right: 15px;
    width: 60px;
    height: 60%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    gap: 30px;
    z-index: 10;
  }
  .video-overlay svg {
    width: 36px;
    height: 36px;
    fill: white;
    cursor: pointer;
    filter: drop-shadow(0 0 2px black);
    transition: transform 0.2s ease;
  }
  .video-overlay svg:hover {
    transform: scale(1.2);
  }
  .popup-ad {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 14px;
    z-index: 20;
    animation: slideDown 0.5s ease forwards;
    opacity: 1;
  }
  @keyframes slideDown {
    from { top: -50px; opacity: 0; }
    to { top: 10px; opacity: 1; }
  }
</style>
</head>
<body>
<div class="feed-container" id="feed">

  <div class="video-slide" data-index="0">
    <div class="portrait-frame">
      <video id="video0" class="video-js" muted playsinline preload="auto">
        <source src="https://customer-7o6zlvriviqc7yeb.cloudflarestream.com/4db8c973d2b2a896c1667064384b3cc8/manifest/video.m3u8" type="application/x-mpegURL" />
      </video>
      <div class="video-overlay">
        <!-- Like -->
        <svg viewBox="0 0 24 24" title="Like">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5
          2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09
          C13.09 3.81 14.76 3 16.5 3
          19.58 3 22 5.42 22 8.5
          c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>

        <!-- Comment -->
        <svg viewBox="0 0 24 24" title="Comment">
          <path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/>
        </svg>

        <!-- Share -->
        <svg viewBox="0 0 24 24" title="Share">
          <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7
          c.05-.23.09-.46.09-.7s-.03-.47-.09-.7l7.02-4.11
          c.53.5 1.23.81 2.01.81
          1.66 0 3-1.34 3-3s-1.34-3-3-3
          -3 1.34-3 3c0 .24.04.47.09.7L8.91 9.81
          C8.38 9.33 7.7 9 7 9
          5.34 9 4 10.34 4 12s1.34 3 3 3
          c.7 0 1.38-.33 1.91-.81l7.12 4.18
          c-.05.21-.08.43-.08.63 0 1.66 1.34 3 3 3s3-1.34 3-3
          -1.34-3-3-3z"/>
        </svg>
      </div>

      <div class="popup-ad">üéÅ Promo Khusus Hari Ini! Geser untuk lihat video selanjutnya.</div>
    </div>
  </div>

  <div class="video-slide" data-index="1">
    <div class="portrait-frame">
      <video id="video1" class="video-js" muted playsinline preload="auto">
        <source src="https://customer-7o6zlvriviqc7yeb.cloudflarestream.com/16429de09d34e277bb8be1fb28b5b86e/manifest/video.m3u8" type="application/x-mpegURL" />
      </video>
      <div class="video-overlay">
        <svg viewBox="0 0 24 24" title="Like">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5
          2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09
          C13.09 3.81 14.76 3 16.5 3
          19.58 3 22 5.42 22 8.5
          c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <svg viewBox="0 0 24 24" title="Comment">
          <path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/>
        </svg>
        <svg viewBox="0 0 24 24" title="Share">
          <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7
          c.05-.23.09-.46.09-.7s-.03-.47-.09-.7l7.02-4.11
          c.53.5 1.23.81 2.01.81
          1.66 0 3-1.34 3-3s-1.34-3-3-3
          -3 1.34-3 3c0 .24.04.47.09.7L8.91 9.81
          C8.38 9.33 7.7 9 7 9
          5.34 9 4 10.34 4 12s1.34 3 3 3
          c.7 0 1.38-.33 1.91-.81l7.12 4.18
          c-.05.21-.08.43-.08.63 0 1.66 1.34 3 3 3s3-1.34 3-3
          -1.34-3-3-3z"/>
        </svg>
      </div>
      <div class="popup-ad">üî• Diskon Spesial! Jangan lewatkan promo ini.</div>
    </div>
  </div>

  <div class="video-slide" data-index="2">
    <div class="portrait-frame">
      <video id="video2" class="video-js" muted playsinline preload="auto">
        <source src="https://customer-7o6zlvriviqc7yeb.cloudflarestream.com/6d426753bf8e59cb7f17ba92f1f54539/manifest/video.m3u8" type="application/x-mpegURL" />
      </video>
      <div class="video-overlay">
        <svg viewBox="0 0 24 24" title="Like">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5
          2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09
          C13.09 3.81 14.76 3 16.5 3
          19.58 3 22 5.42 22 8.5
          c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        <svg viewBox="0 0 24 24" title="Comment">
          <path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/>
        </svg>
        <svg viewBox="0 0 24 24" title="Share">
          <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7
          c.05-.23.09-.46.09-.7s-.03-.47-.09-.7l7.02-4.11
          c.53.5 1.23.81 2.01.81
          1.66 0 3-1.34 3-3s-1.34-3-3-3
          -3 1.34-3 3c0 .24.04.47.09.7L8.91 9.81
          C8.38 9.33 7.7 9 7 9
          5.34 9 4 10.34 4 12s1.34 3 3 3
          c.7 0 1.38-.33 1.91-.81l7.12 4.18
          c-.05.21-.08.43-.08.63 0 1.66 1.34 3 3 3s3-1.34 3-3
          -1.34-3-3-3z"/>
        </svg>
      </div>
      <div class="popup-ad">üì¢ Jangan lewatkan update terbaru dari kami!</div>
    </div>
  </div>

</div>

<!-- Video.js -->
<script src="https://vjs.zencdn.net/8.9.0/video.min.js"></script>
<script>
  const players = [];
  const feed = document.getElementById('feed');
  const slides = feed.querySelectorAll('.video-slide');

  // Inisialisasi semua player dan pause semua kecuali pertama
  slides.forEach((slide, i) => {
    const videoEl = slide.querySelector('video');
    players[i] = videojs(videoEl.id);
    if(i !== 0) players[i].pause();
  });

  // Fungsi pause semua kecuali index tertentu
  function playOnly(index) {
    players.forEach((p, i) => {
      if(i === index){
        p.play();
      } else {
        p.pause();
      }
    });
  }

  // Deteksi slide aktif saat scroll (debounce sederhana)
  let scrollTimeout = null;
  feed.addEventListener('scroll', () => {
    if(scrollTimeout) clearTimeout(scrollTimeout);
    scrollTimeout = setTimeout(() => {
      const scrollTop = feed.scrollTop;
      const vh = window.innerHeight;
      const index = Math.round(scrollTop / vh);
      playOnly(index);

      // Show popup iklan di slide yang aktif
      slides.forEach((slide, i) => {
        const popup = slide.querySelector('.popup-ad');
        if(i === index){
          popup.style.opacity = '1';
          popup.style.display = 'block';
          setTimeout(() => {
            popup.style.opacity = '0';
            setTimeout(() => { popup.style.display = 'none'; }, 400);
          }, 3000);
        } else {
          popup.style.opacity = '0';
          popup.style.display = 'none';
        }
      });
    }, 150);
  });
</script>
</body>
</html>
